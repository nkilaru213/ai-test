
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Endpoint Gemini-style Demo</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM via CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-gray-50">
    <div id="root" class="min-h-screen"></div>

    <script type="text/babel">
      const { useState } = React;

      function App() {
        const [question, setQuestion] = useState("");
        const [messages, setMessages] = useState([]);
        const [loading, setLoading] = useState(false);

        const examples = [
          "My laptop is very slow. What should I check first?",
          "Outlook is not syncing. How do I fix it?",
          "VPN is not connecting when I am working from home.",
          "What can we automate in endpoint operations?"
        ];

        async function sendQuestion(q) {
          const finalQ = q || question;
          if (!finalQ.trim()) return;

          setMessages(prev => [...prev, { from: "user", text: finalQ }]);
          setQuestion("");
          setLoading(true);

          try {
            const res = await fetch("http://127.0.0.1:5050/ask", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ question: finalQ })
            });
            const data = await res.json();
            setMessages(prev => [...prev, { from: "ai", text: data.answer }]);
          } catch (err) {
            setMessages(prev => [...prev, { from: "ai", text: "Backend is not reachable. Make sure Flask is running on port 5050." }]);
          } finally {
            setLoading(false);
          }
        }

        return (
          <div className="flex flex-col items-center justify-start min-h-screen py-16 px-4">
            <div className="w-full max-w-4xl">
              {/* Greeting */}
              <h1 className="text-4xl sm:text-5xl font-semibold text-gray-900 mb-10">
                <span className="text-blue-600">Hello,</span>
              </h1>

              {/* Prompt bar like Gemini */}
              <div className="w-full bg-white rounded-3xl shadow-md border border-gray-100 flex items-center px-6 py-4 mb-6">
                <button className="mr-3 text-gray-500" title="Tools">
                  ⚙️
                </button>
                <input
                  className="flex-1 outline-none text-gray-900 text-base sm:text-lg"
                  placeholder="Enter a prompt for Endpoint Assistant..."
                  value={question}
                  onChange={e => setQuestion(e.target.value)}
                  onKeyDown={e => e.key === "Enter" && sendQuestion()}
                />
                <div className="flex items-center space-x-3 ml-3">
                  <span className="hidden sm:inline text-sm text-gray-500">Fast</span>
                  <button
                    onClick={() => sendQuestion()}
                    className="bg-blue-600 text-white rounded-full px-4 py-1 text-sm font-medium"
                  >
                    Send
                  </button>
                </div>
              </div>

              {/* Suggestion chips */}
              <div className="flex flex-wrap gap-3 mb-10">
                {examples.map((ex, idx) => (
                  <button
                    key={idx}
                    onClick={() => sendQuestion(ex)}
                    className="rounded-full bg-white px-4 py-2 text-sm text-gray-700 shadow border border-gray-100 hover:bg-gray-50"
                  >
                    {ex}
                  </button>
                ))}
              </div>

              {/* Conversation area */}
              <div className="space-y-4">
                {messages.map((m, idx) => (
                  <div
                    key={idx}
                    className={
                      "max-w-3xl rounded-2xl px-4 py-3 text-sm sm:text-base " +
                      (m.from === "user"
                        ? "bg-blue-600 text-white ml-auto"
                        : "bg-white text-gray-900 shadow border border-gray-100")
                    }
                  >
                    {m.text}
                  </div>
                ))}

                {loading && (
                  <div className="inline-flex items-center space-x-2 bg-white rounded-2xl px-4 py-3 shadow border border-gray-100">
                    <span className="text-xs text-gray-500">Thinking</span>
                    <span className="flex space-x-1">
                      <span className="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></span>
                      <span className="w-2 h-2 bg-gray-400 rounded-full animate-bounce [animation-delay:0.1s]"></span>
                      <span className="w-2 h-2 bg-gray-400 rounded-full animate-bounce [animation-delay:0.2s]"></span>
                    </span>
                  </div>
                )}
              </div>
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
